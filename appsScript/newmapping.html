<!DOCTYPE html>
<html>
   <body>

      <p id = "test"></p>

      <p id = "test5">The expected split needs to be performed as:</p>

      <p id = "test2"></p>

      <p id = "test6">Map the following subexpressions to appropriate variable names</p>

      <p id = "let"><pre>
 <label for="var1">sum(B6:B11)</label> --> <input id="var1" name="var1" type="text" placeholder="variable 1" size = "5" onchange="updateFormula()" />
 <label for="var2">C14 / 24</label> --> <input id="var2" name="var2" type="text" placeholder="variable 2" size = "5" onchange="updateFormula()" />
 <label for="var3">B7</label> --> <input id="var3" name="var3" type="text" placeholder="variable 3" size = "5" onchange="updateFormula()" />
 
 Final Formula: <a id="formulaedit"></a>

	    </pre></p>

      <button id = "test7" onclick = "display()">Convert to LET</button>

      <p id = "test4"></p>

      <script>
        google.script.run.withSuccessHandler(function(data) {
          var sidebarContent = document.getElementById('test');
          sidebarContent.innerHTML = data["WarningMessage"];
          sidebarContent = document.getElementById('test2');
          sidebarContent.innerHTML = data["ColoredFormula"];
          sidebarContent = document.getElementById('test3');
          sidebarContent.innerHTML = data["LET"];
        }).getResponseJSON();
        
        function display() {
          google.script.run.withSuccessHandler(function(){
            document.body.innerHTML = "<h1>Done!</h1>";
          }).setLET();
        }

        function updateFormula() {
			var var1 = document.getElementById("var1").value;
			var var2 = document.getElementById("var2").value;
			var var3 = document.getElementById("var3").value;
			var formula = var1 + " * " + var2 + " * " + var3;
			document.getElementById("formulaedit").innerHTML = formula;
		}
      </script>
   </body>
</html>
